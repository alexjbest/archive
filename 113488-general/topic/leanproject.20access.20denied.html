---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/leanproject.20access.20denied.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html">leanproject access denied</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="195840547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195840547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195840547">(Apr 30 2020 at 13:46)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">some-repo</span><span class="p">&gt;</span> <span class="n">leanproject</span> <span class="n">up</span>
<span class="no">[WinError 5]</span> <span class="n">Access</span> <span class="n">is</span> <span class="n">denied</span><span class="err">:</span> <span class="s1">&#39;C:\\some-repo\\_target\\deps\\mathlib\\.git\\objects\\82\\8911039fff7d6ef90ccd33eac0dbe03764acc8&#39;</span>
</code></pre></div>



<a name="195840641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195840641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195840641">(Apr 30 2020 at 13:47)</a>:</h4>
<p>Maybe try <code>leanproject down</code>? /s</p>



<a name="195840706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195840706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195840706">(Apr 30 2020 at 13:47)</a>:</h4>
<p>Do you have read/write access to that file?</p>



<a name="195840827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195840827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195840827">(Apr 30 2020 at 13:48)</a>:</h4>
<p>As in, can you verify this using other means?</p>



<a name="195840979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195840979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195840979">(Apr 30 2020 at 13:49)</a>:</h4>
<p>well I can open it in NotePad++</p>



<a name="195841108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195841108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195841108">(Apr 30 2020 at 13:50)</a>:</h4>
<p>and I can <code>cat</code> it in the same terminal</p>



<a name="195841407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195841407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195841407">(Apr 30 2020 at 13:52)</a>:</h4>
<p>Weird...</p>



<a name="195841452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195841452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195841452">(Apr 30 2020 at 13:52)</a>:</h4>
<p>Can you edit it or is it read only?</p>



<a name="195841506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195841506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Steffan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195841506">(Apr 30 2020 at 13:53)</a>:</h4>
<p>open command prompt as administrator</p>



<a name="195841585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195841585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Steffan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195841585">(Apr 30 2020 at 13:53)</a>:</h4>
<p>then try again?</p>



<a name="195841740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195841740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Steffan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195841740">(Apr 30 2020 at 13:54)</a>:</h4>
<p>delete .git folder and try again, maybe?</p>



<a name="195842074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842074">(Apr 30 2020 at 13:57)</a>:</h4>
<p>The risk with that is that you lose all your local branches</p>



<a name="195842127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842127">(Apr 30 2020 at 13:57)</a>:</h4>
<p>When I've seen errors like that before it's been stuff like disk corruption</p>



<a name="195842145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Steffan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842145">(Apr 30 2020 at 13:57)</a>:</h4>
<p>Yes, but if you don't care about git so much, like me</p>



<a name="195842229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842229">(Apr 30 2020 at 13:58)</a>:</h4>
<p>very interestingly, renaming it to <code>.git_old</code> doesn't help, but moving it to another place made it work</p>



<a name="195842260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842260">(Apr 30 2020 at 13:58)</a>:</h4>
<p>it was very strange: after I rename it to <code>.git_old</code> it gives me the same error message with <code>.git</code> replaced with <code>.git_old</code></p>



<a name="195842290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Steffan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842290">(Apr 30 2020 at 13:58)</a>:</h4>
<p>what if you take the <code>.</code> off?</p>



<a name="195842333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195842333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195842333">(Apr 30 2020 at 13:59)</a>:</h4>
<p>When I've seen copying stuff to other places fixing things, it has been disk corruption</p>



<a name="195946935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195946935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195946935">(May 01 2020 at 10:06)</a>:</h4>
<p>I have reproduced this error</p>



<a name="195946954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195946954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195946954">(May 01 2020 at 10:06)</a>:</h4>
<ol>
<li>delete the .git folder</li>
<li><code>leanproject up</code></li>
<li>this works fine, and it clones mathlib</li>
<li><code>leanproject up</code></li>
<li>error</li>
</ol>



<a name="195946965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195946965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195946965">(May 01 2020 at 10:06)</a>:</h4>
<p>so basically it cannot be executed twice</p>



<a name="195947076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195947076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195947076">(May 01 2020 at 10:08)</a>:</h4>
<p>Open an issue in the GitHub repo and Patrick will look at it when he has time. Nice sleuthing.</p>



<a name="195947083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195947083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195947083">(May 01 2020 at 10:09)</a>:</h4>
<p>the environment is in the VSCode Terminal on Windows 10</p>



<a name="195947091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195947091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195947091">(May 01 2020 at 10:09)</a>:</h4>
<p>which uses powershell</p>



<a name="195947267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195947267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195947267">(May 01 2020 at 10:11)</a>:</h4>
<p>debug:</p>
<div class="codehilite"><pre><span></span><code>Traceback (most recent call last):
  File &quot;c:\python-3.6.4\lib\runpy.py&quot;, line 193, in _run_module_as_main
    &quot;__main__&quot;, mod_spec)
  File &quot;c:\python-3.6.4\lib\runpy.py&quot;, line 85, in _run_code
    exec(code, run_globals)
  File &quot;C:\Python-3.6.4\Scripts\leanproject.exe\__main__.py&quot;, line 7, in &lt;module&gt;
  File &quot;c:\python-3.6.4\lib\site-packages\mathlibtools\leanproject.py&quot;, line 256, in safe_cli
    handle_exception(err, str(err))
  File &quot;c:\python-3.6.4\lib\site-packages\mathlibtools\leanproject.py&quot;, line 51, in handle_exception
    raise exc
  File &quot;c:\python-3.6.4\lib\site-packages\mathlibtools\leanproject.py&quot;, line 254, in safe_cli
    cli()
  File &quot;c:\python-3.6.4\lib\site-packages\click\core.py&quot;, line 829, in __call__
    return self.main(*args, **kwargs)
  File &quot;c:\python-3.6.4\lib\site-packages\click\core.py&quot;, line 782, in main
    rv = self.invoke(ctx)
  File &quot;c:\python-3.6.4\lib\site-packages\click\core.py&quot;, line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File &quot;c:\python-3.6.4\lib\site-packages\click\core.py&quot;, line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File &quot;c:\python-3.6.4\lib\site-packages\click\core.py&quot;, line 610, in invoke
    return callback(*args, **kwargs)
  File &quot;c:\python-3.6.4\lib\site-packages\mathlibtools\leanproject.py&quot;, line 92, in upgrade_mathlib
    proj().upgrade_mathlib()
  File &quot;c:\python-3.6.4\lib\site-packages\mathlibtools\lib.py&quot;, line 468, in upgrade_mathlib
    shutil.rmtree(str(self.mathlib_folder))
  File &quot;c:\python-3.6.4\lib\shutil.py&quot;, line 494, in rmtree
    return _rmtree_unsafe(path, onerror)
  File &quot;c:\python-3.6.4\lib\shutil.py&quot;, line 384, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File &quot;c:\python-3.6.4\lib\shutil.py&quot;, line 384, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File &quot;c:\python-3.6.4\lib\shutil.py&quot;, line 384, in _rmtree_unsafe
    _rmtree_unsafe(fullname, onerror)
  File &quot;c:\python-3.6.4\lib\shutil.py&quot;, line 389, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File &quot;c:\python-3.6.4\lib\shutil.py&quot;, line 387, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 5] Access is denied: &#39;C:\\some-repo\\_target\\deps\\mathlib\\.git\\objects\\pack\\pack-36f591561703d876c8ad32e4cc46887e2a0bf6d2.idx&#39;
</code></pre></div>



<a name="195947420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195947420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195947420">(May 01 2020 at 10:14)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib-tools/issues/46" title="https://github.com/leanprover-community/mathlib-tools/issues/46">https://github.com/leanprover-community/mathlib-tools/issues/46</a></p>



<a name="195947953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195947953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195947953">(May 01 2020 at 10:23)</a>:</h4>
<p>I tried to reproduce, but you need to give more details. Here is what I did, in a folder containing a cloned copy of mathlib: I deleted the <code>.git</code> folder, and then I ran <code>leanproject up</code> several times. The output is</p>
<div class="codehilite"><pre><span></span><code><span class="n">PS</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Sebastien</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">mathlib_klau</span><span class="bp">&gt;</span> <span class="n">leanproject</span> <span class="n">up</span>
<span class="err">&#39;</span><span class="n">dependencies&#39;</span>
<span class="n">PS</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Sebastien</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">mathlib_klau</span><span class="bp">&gt;</span> <span class="n">leanproject</span> <span class="n">up</span>
<span class="err">&#39;</span><span class="n">dependencies&#39;</span>
<span class="n">PS</span> <span class="n">C</span><span class="o">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">Sebastien</span><span class="err">\</span><span class="n">Desktop</span><span class="err">\</span><span class="n">mathlib_klau</span><span class="bp">&gt;</span> <span class="n">leanproject</span> <span class="n">up</span>
<span class="err">&#39;</span><span class="n">dependencies&#39;</span>
</code></pre></div>


<p>It doesn't create a <code>.git</code> folder. I am not surprised it doesn't work, because <code>leanproject up</code> is supposed to use <code>.git</code>.</p>



<a name="195948055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195948055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195948055">(May 01 2020 at 10:24)</a>:</h4>
<p>I should specify that this is in a repo using mathlib</p>



<a name="195948353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195948353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195948353">(May 01 2020 at 10:29)</a>:</h4>
<p>This is still not enough for me. Details that you did not specify: is mathlib in a different directory with its own git structure, or is it in a subdirectory of your project, what does the <code>.toml</code> look like, and so on. Ideally, I would just have a github branch to clone, and then I could start experimenting.</p>



<a name="195948996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195948996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195948996">(May 01 2020 at 10:38)</a>:</h4>
<p><span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> <a href="https://github.com/kckennylau/test" title="https://github.com/kckennylau/test">https://github.com/kckennylau/test</a></p>



<a name="195950443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195950443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195950443">(May 01 2020 at 10:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/113488-general/topic/leanproject.20access.20denied/near/195948996" title="#narrow/stream/113488-general/topic/leanproject.20access.20denied/near/195948996">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110050">Sebastien Gouezel</span> <a href="https://github.com/kckennylau/test" title="https://github.com/kckennylau/test">https://github.com/kckennylau/test</a></p>
</blockquote>
<p>I cloned your repo. <code>leanproject up</code> feels a bit slow when i run it (compared to when I run in mathlib). But it succeeds. Same when I run the command a 2nd time.</p>



<a name="195951564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195951564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195951564">(May 01 2020 at 11:17)</a>:</h4>
<p>FWIW I can reproduce this on Windows, both Powershell and Git Bash. Running Powershell as admin doesn't fix it, I don't immediately see an issue with the file permissions, I don't see a process blocking write access to that file. Out of time to troubleshoot further right now though.</p>



<a name="195951886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195951886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195951886">(May 01 2020 at 11:21)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> thanks for your reproduction.</p>



<a name="195956132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195956132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195956132">(May 01 2020 at 12:30)</a>:</h4>
<p>I am doing something wrong:</p>
<div class="codehilite"><pre><span></span><code>PS C:\Users\Sebastien\Desktop\essai&gt; leanproject --version
leanproject, version 0.0.5
PS C:\Users\Sebastien\Desktop\essai&gt; git clone https://github.com/kckennylau/test.git
Cloning into &#39;test&#39;...
remote: Enumerating objects: 6, done.
remote: Counting objects: 100% (6/6), done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 6 (delta 0), reused 6 (delta 0), pack-reused 0
Unpacking objects: 100% (6/6), done.
PS C:\Users\Sebastien\Desktop\essai&gt; cd test
PS C:\Users\Sebastien\Desktop\essai\test&gt; leanproject up
[WinError 2] Le fichier spécifié est introuvable
</code></pre></div>



<a name="195956529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195956529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195956529">(May 01 2020 at 12:36)</a>:</h4>
<p>This is really windows specific. I couldn't reproduce here.</p>



<a name="195956574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195956574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195956574">(May 01 2020 at 12:36)</a>:</h4>
<p>Did you try <code>leanproject --debug up</code>?</p>



<a name="195956697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195956697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195956697">(May 01 2020 at 12:38)</a>:</h4>
<p>Are you asking Kenny or me?</p>
<p>For me, I get</p>
<div class="codehilite"><pre><span></span><code>PS C:\Users\Sebastien\Desktop\essai\test&gt; leanproject --debug up
Traceback (most recent call last):
  File &quot;C:\Program Files\Python37\Scripts\leanproject-script.py&quot;, line 11, in &lt;module&gt;
    load_entry_point(&#39;mathlibtools==0.0.5&#39;, &#39;console_scripts&#39;, &#39;leanproject&#39;)()
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 295, in safe_cli
    handle_exception(err, str(err))
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 51, in handle_exception
    raise exc
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 293, in safe_cli
    cli()
  File &quot;c:\program files\python37\lib\site-packages\click\core.py&quot;, line 764, in __call__
    return self.main(*args, **kwargs)
  File &quot;c:\program files\python37\lib\site-packages\click\core.py&quot;, line 717, in main
    rv = self.invoke(ctx)
  File &quot;c:\program files\python37\lib\site-packages\click\core.py&quot;, line 1137, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File &quot;c:\program files\python37\lib\site-packages\click\core.py&quot;, line 956, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File &quot;c:\program files\python37\lib\site-packages\click\core.py&quot;, line 555, in invoke
    return callback(*args, **kwargs)
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\leanproject.py&quot;, line 93, in upgrade_mathlib
    proj().upgrade_mathlib()
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\lib.py&quot;, line 592, in upgrade_mathlib
    self.run([&#39;leanpkg&#39;, &#39;upgrade&#39;])
  File &quot;c:\program files\python37\lib\site-packages\mathlibtools\lib.py&quot;, line 528, in run
    check=True).stdout.decode()
  File &quot;c:\program files\python37\lib\subprocess.py&quot;, line 472, in run
    with Popen(*popenargs, **kwargs) as process:
  File &quot;c:\program files\python37\lib\subprocess.py&quot;, line 775, in __init__
    restore_signals, start_new_session)
  File &quot;c:\program files\python37\lib\subprocess.py&quot;, line 1178, in _execute_child
    startupinfo)
FileNotFoundError: [WinError 2] Le fichier spécifié est introuvable
</code></pre></div>


<p>But I want to stress that, for my usual case (<code>leanproject up</code> in a mathlib directory), everything works perfectly.</p>



<a name="195960639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195960639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195960639">(May 01 2020 at 13:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> I have produced the output of <code>leanproject --debug up</code> in the issue</p>



<a name="195965073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195965073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195965073">(May 01 2020 at 14:19)</a>:</h4>
<p>It fails to remove files in the mathlib folder. What happens if you try to remove it by hand?</p>



<a name="195966413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/195966413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#195966413">(May 01 2020 at 14:32)</a>:</h4>
<p>if I remove the <code>.git</code> folder then <code>leanproject up</code> does work, but only once</p>



<a name="196605635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196605635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196605635">(May 06 2020 at 09:02)</a>:</h4>
<p>I just ran into this in practice. The <code>.idx</code> file does indeed seem to be read-only, which prevents <code>shutil.rmtree</code> from deleting it.</p>



<a name="196605673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196605673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196605673">(May 06 2020 at 09:02)</a>:</h4>
<p>One workaround: <a href="https://stackoverflow.com/questions/21261132/shutil-rmtree-to-remove-readonly-files" title="https://stackoverflow.com/questions/21261132/shutil-rmtree-to-remove-readonly-files">https://stackoverflow.com/questions/21261132/shutil-rmtree-to-remove-readonly-files</a> although blindly deleting read-only stuff is maybe not the smartest thing to do.</p>



<a name="196605936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196605936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196605936">(May 06 2020 at 09:05)</a>:</h4>
<p>What is this .idx file?</p>



<a name="196606021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196606021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196606021">(May 06 2020 at 09:05)</a>:</h4>
<p>Oh, in git?</p>



<a name="196606033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196606033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196606033">(May 06 2020 at 09:05)</a>:</h4>
<p>Windows is so weird</p>



<a name="196606100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196606100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196606100">(May 06 2020 at 09:06)</a>:</h4>
<div class="codehilite"><pre><span></span><code>robyl@DESKTOP-SMPP1GQ MINGW64 /d/lean/doc-gen <span class="o">(</span>master<span class="o">)</span>
$ leanproject up
<span class="o">[</span>WinError <span class="m">5</span><span class="o">]</span> Access is denied: <span class="s1">&#39;D:\\lean\\doc-gen\\_target\\deps\\mathlib\\.git\\objects\\pack\\pack-1be031bb56944e0cd6652e34e4ab97cadbe780f9.idx&#39;</span>
</code></pre></div>



<a name="196606191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196606191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196606191">(May 06 2020 at 09:06)</a>:</h4>
<p>If this is only .idx files in .git we can have a rule for them instead of blindly deleting read-only files</p>



<a name="196606206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20access%20denied/near/196606206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20access.20denied.html#196606206">(May 06 2020 at 09:07)</a>:</h4>
<p>Feel free to submit a patch to leanproject.</p>



{% endraw %}

<hr><p>Last updated: May 10 2020 at 08:08 UTC</p>