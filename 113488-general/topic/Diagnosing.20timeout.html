---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Diagnosing.20timeout.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html">Diagnosing timeout</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="195833392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195833392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195833392">(Apr 30 2020 at 12:46)</a>:</h4>
<p>I'm getting a confusing deterministic timeout - with the last line of my proof there's a timeout but without it there isn't, and if I reorder the proof to have a different last line, still the last line gives a timeout. I haven't used anything like simp or tidy, and I'm pretty sure there shouldn't be any difficult typeclass searches either. What sort of thing could I do to figure out why it's timing out? (I can't really post an MWE since it's on top of thousands of lines of topos code but the proof is:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">sheaf_exponential</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">exp</span> <span class="n">A</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">,</span>
  <span class="n">unique_extend</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">B</span> <span class="n">B&#39;</span> <span class="n">m</span> <span class="n">f&#39;</span> <span class="n">d</span><span class="o">,</span>
  <span class="k">begin</span>
    <span class="n">haveI</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">dense_prod_map_id</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">j</span> <span class="bp">_</span> <span class="n">A</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">m</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨⟨⟨</span><span class="n">cchat</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">exp_transpose_natural_left</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">f&#39;</span> <span class="o">},</span>
    <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">z</span> <span class="o">:</span> <span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span> <span class="err">≫</span> <span class="n">unhat</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">exp_transpose_natural_left_symm</span> <span class="n">m</span> <span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">],</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">unhat</span> <span class="n">a</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">congr</span><span class="o">,</span>
    <span class="n">symmetry</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">A</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">a</span><span class="o">,</span>
  <span class="kn">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="195833617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195833617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195833617">(Apr 30 2020 at 12:49)</a>:</h4>
<p>I'm not sure if it makes a difference but the proof of <code>dense_prod_map_id</code> is currently sorry</p>



<a name="195833653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195833653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195833653">(Apr 30 2020 at 12:49)</a>:</h4>
<p>and without the final line of the proof, it's very quick to show me the tactic state</p>



<a name="195833884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195833884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195833884">(Apr 30 2020 at 12:51)</a>:</h4>
<p>are there other fields of <code>sheaf</code> you haven't provided?</p>



<a name="195833898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195833898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195833898">(Apr 30 2020 at 12:51)</a>:</h4>
<p>Nope</p>



<a name="195834909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195834909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195834909">(Apr 30 2020 at 13:01)</a>:</h4>
<p>You can try turning on various trace flags, and see whether anything looks obviously out of control. Otherwise, I am afraid it's not easy to tell what's going on</p>



<a name="195835003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835003">(Apr 30 2020 at 13:01)</a>:</h4>
<p>One possibility is that you actually have a type error and Lean is going on an unfolding spree to see if it can be reduced away</p>



<a name="195835097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835097">(Apr 30 2020 at 13:02)</a>:</h4>
<p>Are there any trace flags I should try first? <code>trace.class_instances</code> didn't seem out of control</p>



<a name="195835237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835237">(Apr 30 2020 at 13:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195835003" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195835003">said</a>:</p>
<blockquote>
<p>One possibility is that you actually have a type error and Lean is going on an unfolding spree to see if it can be reduced away</p>
</blockquote>
<p>This makes sense, but if I reorder the proof (eg changing the <code>have z</code> to a <code>suffices</code>) there's no type error for the alternative last line</p>



<a name="195835283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835283">(Apr 30 2020 at 13:04)</a>:</h4>
<p>For clarity, by reordered proof I mean:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">sheaf_exponential</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">exp</span> <span class="n">A</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">,</span>
  <span class="n">unique_extend</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">B</span> <span class="n">B&#39;</span> <span class="n">m</span> <span class="n">f&#39;</span> <span class="n">d</span><span class="o">,</span>
  <span class="k">begin</span>
    <span class="n">haveI</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">dense_prod_map_id</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">j</span> <span class="bp">_</span> <span class="n">A</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">m</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨⟨⟨</span><span class="n">cchat</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">exp_transpose_natural_left</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">f&#39;</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">suffices</span> <span class="n">z</span> <span class="o">:</span> <span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span> <span class="err">≫</span> <span class="n">unhat</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">unhat</span> <span class="n">a</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟩</span><span class="o">,</span>
        <span class="n">congr</span><span class="o">,</span>
        <span class="n">symmetry</span><span class="o">,</span>
        <span class="n">refine</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">A</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">a</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">exp_transpose_natural_left_symm</span> <span class="n">m</span> <span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">],</span>
    <span class="o">}</span>
  <span class="kn">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="195835390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835390">(Apr 30 2020 at 13:04)</a>:</h4>
<p>In both cases commenting out the last line (in the latter case, just the <code>ha</code>) tells me quickly that the goal isn't solved and there's no other errors</p>



<a name="195835402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835402">(Apr 30 2020 at 13:04)</a>:</h4>
<p>maybe <code>set_option trace.type_context.is_def_eq true</code></p>



<a name="195835923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195835923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195835923">(Apr 30 2020 at 13:09)</a>:</h4>
<p>Doesn't seem to be crazy, one of the rw gives a pretty long trace but most of it says success</p>



<a name="195836978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195836978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195836978">(Apr 30 2020 at 13:18)</a>:</h4>
<p>Post a MWE anyway. Seriously. Of the form "download this branch of this repo, and look at this line in this file". When people did this in the past I just thought they were taking the mickey. But now with leanproject it's much easier.</p>



<a name="195837143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195837143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195837143">(Apr 30 2020 at 13:20)</a>:</h4>
<p>Well, something must be happening where Lean starts taking time.</p>



<a name="195837169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195837169" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195837169">(Apr 30 2020 at 13:20)</a>:</h4>
<p>In the past I have occasionally resorted to running Lean in a debugger, then stopping it at a random point and looking at the trace</p>



<a name="195837876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195837876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195837876">(Apr 30 2020 at 13:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195836978" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195836978">said</a>:</p>
<blockquote>
<p>Post a MWE anyway. Seriously. Of the form "download this branch of repo, and look at this line in this file". When people did this in the past I just thought they were taking the mickey. But now with leanproject it's much easier.</p>
</blockquote>
<p>The final line in <a href="https://github.com/b-mehta/topos/blob/sheaf/src/sheaf.lean" title="https://github.com/b-mehta/topos/blob/sheaf/src/sheaf.lean">https://github.com/b-mehta/topos/blob/sheaf/src/sheaf.lean</a> - download the sheaf branch of the repo. (It's not particularly minimal)</p>



<a name="195860476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195860476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195860476">(Apr 30 2020 at 15:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195837169" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195837169">said</a>:</p>
<blockquote>
<p>In the past I have occasionally resorted to running Lean in a debugger, then stopping it at a random point and looking at the trace</p>
</blockquote>
<p>How could I do this?</p>



<a name="195866461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195866461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195866461">(Apr 30 2020 at 16:39)</a>:</h4>
<p>If I add another line (eg simp) before the <code>end</code>, it says the tactic state is <code>goals accomplished</code> and the simp fails with match failed, no goals; and this happens quickly</p>



<a name="195869576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195869576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195869576">(Apr 30 2020 at 16:57)</a>:</h4>
<p>My guess is that you should try to fill in the sorry of <code>dense_prod_map_id</code>: it is not a Prop, so what you put in there is important.</p>
<p>By the way, all these classes (<code>dense</code>, <code>closed</code>) are not Props because <code>is_iso</code> is not Prop either. Does it really create problems to turn <code>is_iso</code> into a Prop, just requiring the existence of an inverse -- and having a convenience function <code>is_iso.inverse</code> that would pull the inverse out of choice?</p>



<a name="195869737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195869737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195869737">(Apr 30 2020 at 16:58)</a>:</h4>
<p>This is the big "category_theory uses data, not Props" question...</p>



<a name="195869849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195869849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195869849">(Apr 30 2020 at 16:59)</a>:</h4>
<p>The same thing with <code>has_limits</code> etc...</p>



<a name="195870021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195870021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195870021">(Apr 30 2020 at 17:00)</a>:</h4>
<p>Yeah I think it has to be all or nothing - we've got to have everything as a Prop or everything as data otherwise things won't play well with each other</p>



<a name="195870328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195870328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195870328">(Apr 30 2020 at 17:02)</a>:</h4>
<p>If the data is not unique, then I understand you need to keep the data and record the way it is constructed. But when the data is unique like the inverse, I don't see the point.</p>



<a name="195870702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195870702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195870702">(Apr 30 2020 at 17:05)</a>:</h4>
<p>In some cases, the data might only be unique up to (unique) isomorphism, but also in category theory (and topos theory) we often try to avoid using choice, so just the existence of a unique object isn't enough</p>



<a name="195870863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195870863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195870863">(Apr 30 2020 at 17:06)</a>:</h4>
<p>It's also reasonably common to take "has limits" in category theory to mean "we are given a particular choice of limit for every diagram", which matches lean's current definition</p>



<a name="195870981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195870981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195870981">(Apr 30 2020 at 17:07)</a>:</h4>
<p><a href="/user_uploads/3121/0Z1rlCc5VdNPOiDKBmBv2RPo/image.png" title="image.png">eg just after Lemma A1.2.1 in the Elephant</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/0Z1rlCc5VdNPOiDKBmBv2RPo/image.png" title="eg just after Lemma A1.2.1 in the Elephant"><img src="/user_uploads/3121/0Z1rlCc5VdNPOiDKBmBv2RPo/image.png"></a></div>



<a name="195871331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871331">(Apr 30 2020 at 17:09)</a>:</h4>
<p>Only very picky people and theorem provers would consider "having limits" to mean a choice of limits.</p>



<a name="195871532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871532">(Apr 30 2020 at 17:11)</a>:</h4>
<p>I won't tell PTJ you called him picky :P</p>



<a name="195871547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871547">(Apr 30 2020 at 17:11)</a>:</h4>
<p>I'm pretty sure this is the convention in MM as well</p>



<a name="195871637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871637">(Apr 30 2020 at 17:12)</a>:</h4>
<p>metamath?</p>



<a name="195871653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871653">(Apr 30 2020 at 17:12)</a>:</h4>
<p>Maclane-Moerdijk</p>



<a name="195871693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871693">(Apr 30 2020 at 17:12)</a>:</h4>
<p>I think this is mainly in the eye of the beholder</p>



<a name="195871885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871885">(Apr 30 2020 at 17:14)</a>:</h4>
<p>Just like, "obviously", most category theory texts mean <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">U</mi></mrow><annotation encoding="application/x-tex">\mathcal{U}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span></span></span>-small category for some universe <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">U</mi></mrow><annotation encoding="application/x-tex">\mathcal{U}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span></span></span> even if they never mention universes</p>



<a name="195871917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871917">(Apr 30 2020 at 17:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195871693" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195871693">said</a>:</p>
<blockquote>
<p>I think this is mainly in the eye of the beholder</p>
</blockquote>
<p>Maybe, but it is explicitly discussed and mentioned in the Elephant</p>



<a name="195871956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195871956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195871956">(Apr 30 2020 at 17:15)</a>:</h4>
<p>My guess is these picky people have to rely on the fact that there is nobody even pickier who wants to dismantle their position</p>



<a name="195876596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195876596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195876596">(Apr 30 2020 at 17:51)</a>:</h4>
<p>So I tried some preliminary investigations:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">...</span>
    <span class="n">congr</span><span class="o">,</span>
    <span class="n">symmetry</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">ZZZ</span> <span class="o">:=</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">A</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">cchat</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">unhat</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">at</span> <span class="n">ZZZ</span><span class="o">,</span>
    <span class="n">dsimp</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="n">at</span> <span class="n">ZZZ</span><span class="o">,</span>
    <span class="n">dunfold</span> <span class="n">exp_transpose</span><span class="o">,</span>
    <span class="n">sorry</span>
  <span class="kn">end</span>
</code></pre></div>



<a name="195876726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195876726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195876726">(Apr 30 2020 at 17:52)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">ZZZ</span> <span class="o">:</span> <span class="err">⇑</span><span class="o">(</span><span class="n">is_left_adjoint</span><span class="bp">.</span><span class="n">adj</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="n">B</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="err">⇑</span><span class="o">(</span><span class="n">equiv</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="n">is_left_adjoint</span><span class="bp">.</span><span class="n">adj</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="n">B</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">))</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span>
<span class="err">⊢</span> <span class="err">⇑</span><span class="o">(</span><span class="n">is_left_adjoint</span><span class="bp">.</span><span class="n">adj</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="n">B</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="err">⇑</span><span class="o">(</span><span class="n">equiv</span><span class="bp">.</span><span class="n">symm</span> <span class="o">(</span><span class="n">is_left_adjoint</span><span class="bp">.</span><span class="n">adj</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="n">B</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">))</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span>
</code></pre></div>



<a name="195876757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195876757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195876757">(Apr 30 2020 at 17:53)</a>:</h4>
<p>and <code>exact ZZZ</code> or <code>convert ZZZ</code> causes the timeout</p>



<a name="195876813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195876813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195876813">(Apr 30 2020 at 17:53)</a>:</h4>
<p>So of course when you <code>set_option pp.all true</code> you find that the terms are different.</p>



<a name="195876931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195876931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195876931">(Apr 30 2020 at 17:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="246273">Bhavik Mehta</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195835283" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195835283">said</a>:</p>
<blockquote>
<p>For clarity, by reordered proof I mean:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">sheaf_exponential</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">exp</span> <span class="n">A</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">,</span>
  <span class="n">unique_extend</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">B</span> <span class="n">B&#39;</span> <span class="n">m</span> <span class="n">f&#39;</span> <span class="n">d</span><span class="o">,</span>
  <span class="k">begin</span>
    <span class="n">haveI</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">dense_prod_map_id</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">j</span> <span class="bp">_</span> <span class="n">A</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">m</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨⟨⟨</span><span class="n">cchat</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">exp_transpose_natural_left</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">f&#39;</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">suffices</span> <span class="n">z</span> <span class="o">:</span> <span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span> <span class="err">≫</span> <span class="n">unhat</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">unhat</span> <span class="n">a</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟩</span><span class="o">,</span>
        <span class="n">congr</span><span class="o">,</span>
        <span class="n">symmetry</span><span class="o">,</span>
        <span class="n">refine</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">A</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">a</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">exp_transpose_natural_left_symm</span> <span class="n">m</span> <span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">],</span>
    <span class="o">}</span>
  <span class="kn">end</span>
<span class="o">}</span>
</code></pre></div>


</blockquote>
<p>Yeah I get a timeout as well with exact ZZZ, but with the re-ordered version of the code that version doesn't give a type error</p>



<a name="195876945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195876945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195876945">(Apr 30 2020 at 17:54)</a>:</h4>
<p>and that doesn't explain why it's fine if you put a simp afterwards</p>



<a name="195877025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195877025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195877025">(Apr 30 2020 at 17:55)</a>:</h4>
<p>My current hypothesis is that Sebastian's right, and the problem happens when lean is trying to make the bytecode, so I'm currently filling in the sorry</p>



<a name="195877247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195877247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195877247">(Apr 30 2020 at 17:56)</a>:</h4>
<p><a href="https://gist.github.com/kbuzzard/7eb4998162960f7c0e1f975c8d199a71" title="https://gist.github.com/kbuzzard/7eb4998162960f7c0e1f975c8d199a71">ZZZ</a> vs <a href="https://gist.github.com/kbuzzard/81c432ac5a5282a4baf3ce789e358519" title="https://gist.github.com/kbuzzard/81c432ac5a5282a4baf3ce789e358519">goal</a>; <a href="https://gist.github.com/kbuzzard/8cd788951b49a3ff536c3dce71e085e0" title="https://gist.github.com/kbuzzard/8cd788951b49a3ff536c3dce71e085e0">diff</a></p>



<a name="195877334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195877334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195877334">(Apr 30 2020 at 17:57)</a>:</h4>
<p>Looking at the first diff, that's defeq by how I defined <code>exp</code></p>



<a name="195878290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195878290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195878290">(Apr 30 2020 at 18:04)</a>:</h4>
<p>There are no sorrys in ZZZ or the goal though</p>



<a name="195878382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195878382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195878382">(Apr 30 2020 at 18:05)</a>:</h4>
<p>Hmm</p>



<a name="195878861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195878861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195878861">(Apr 30 2020 at 18:09)</a>:</h4>
<p>Oh this is interesting</p>



<a name="195879038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879038">(Apr 30 2020 at 18:10)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">sheaf_exponential</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">exp</span> <span class="n">A</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">,</span>
  <span class="n">unique_extend</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">B</span> <span class="n">B&#39;</span> <span class="n">m</span> <span class="n">f&#39;</span> <span class="n">d</span><span class="o">,</span>
  <span class="k">begin</span>
    <span class="n">haveI</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">dense_prod_map_id</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">j</span> <span class="bp">_</span> <span class="n">A</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">m</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨⟨⟨</span><span class="n">cchat</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">exp_transpose_natural_left</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">f&#39;</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">suffices</span> <span class="n">z</span> <span class="o">:</span> <span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span> <span class="err">≫</span> <span class="n">unhat</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">unhat</span> <span class="n">a</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟩</span><span class="o">,</span>
        <span class="n">congr</span><span class="o">,</span>
        <span class="n">symmetry</span><span class="o">,</span>
        <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">A</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">a</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">exp_transpose_natural_left_symm</span> <span class="n">m</span> <span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">],</span>
      <span class="n">sorry</span><span class="o">,</span>
    <span class="o">},</span>
  <span class="kn">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="195879090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879090">(Apr 30 2020 at 18:10)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Tactic</span> <span class="n">State</span>
<span class="n">goals</span> <span class="n">accomplished</span>
<span class="n">sheaf</span><span class="bp">.</span><span class="n">lean</span><span class="o">:</span><span class="mi">184</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span> <span class="n">error</span>
<span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">there</span> <span class="n">are</span> <span class="n">no</span> <span class="n">goals</span> <span class="n">to</span> <span class="n">be</span> <span class="n">solved</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">no</span> <span class="n">goals</span>
</code></pre></div>



<a name="195879130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879130">(Apr 30 2020 at 18:10)</a>:</h4>
<p>the error is on the sorry, complaining that I'm apologising when I'm all done.</p>



<a name="195879171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879171">(Apr 30 2020 at 18:11)</a>:</h4>
<p>Right - this is the same as the simp thing I saw earlier</p>



<a name="195879176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879176">(Apr 30 2020 at 18:11)</a>:</h4>
<p>Really weird!</p>



<a name="195879180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879180">(Apr 30 2020 at 18:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">sheaf_exponential</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span><span class="o">)</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="n">C</span> <span class="n">j</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">A</span> <span class="o">:=</span> <span class="n">exp</span> <span class="n">A</span> <span class="n">s</span><span class="bp">.</span><span class="n">A</span><span class="o">,</span>
  <span class="n">unique_extend</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">B</span> <span class="n">B&#39;</span> <span class="n">m</span> <span class="n">f&#39;</span> <span class="n">d</span><span class="o">,</span>
  <span class="k">begin</span>
    <span class="n">haveI</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">dense_prod_map_id</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">j</span> <span class="bp">_</span> <span class="n">A</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">m</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">refine</span> <span class="bp">⟨⟨⟨</span><span class="n">cchat</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="bp">_⟩⟩</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">exp_transpose_natural_left</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
      <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">f&#39;</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span><span class="o">,</span>
      <span class="n">suffices</span> <span class="n">z</span> <span class="o">:</span> <span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span> <span class="err">≫</span> <span class="n">unhat</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="o">(</span><span class="n">s</span><span class="bp">.</span><span class="n">unique_extend</span> <span class="o">(</span><span class="n">limits</span><span class="bp">.</span><span class="n">prod</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="mi">𝟙</span> <span class="n">A</span><span class="o">)</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">unhat</span> <span class="n">f&#39;</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">unhat</span> <span class="n">a</span><span class="o">,</span> <span class="n">z</span><span class="bp">⟩</span><span class="o">,</span>
        <span class="n">congr</span><span class="o">,</span>
        <span class="n">symmetry</span><span class="o">,</span>
        <span class="n">exact</span> <span class="o">((</span><span class="n">exp</span><span class="bp">.</span><span class="n">adjunction</span> <span class="n">A</span><span class="o">)</span><span class="bp">.</span><span class="n">hom_equiv</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">right_inv</span> <span class="n">a</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">exp_transpose_natural_left_symm</span> <span class="n">m</span> <span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">],</span>
    <span class="o">},</span>
    <span class="n">sorry</span>
  <span class="kn">end</span>
<span class="o">}</span>
</code></pre></div>


<p>same error</p>



<a name="195879226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879226">(Apr 30 2020 at 18:11)</a>:</h4>
<p>I've seen Lean in sort of this state before -- there are hidden goals. There's a tactic which makes them come out</p>



<a name="195879347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879347">(Apr 30 2020 at 18:12)</a>:</h4>
<p>But I don't think there are hidden goals! In all the code I've written I haven't used any <code>. obviously</code> or anything</p>



<a name="195879486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879486">(Apr 30 2020 at 18:13)</a>:</h4>
<p>Sometimes a tactic just leaves some hidden goals behind by accident</p>



<a name="195879497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195879497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195879497">(Apr 30 2020 at 18:13)</a>:</h4>
<p>True</p>



<a name="195880019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880019">(Apr 30 2020 at 18:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="246273">Bhavik Mehta</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195877025" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195877025">said</a>:</p>
<blockquote>
<p>My current hypothesis is that Sebastian's right, and the problem happens when lean is trying to make the bytecode, so I'm currently filling in the sorry</p>
</blockquote>
<p>You probably mean Sébastien here. I don't know why Zulip doesn't use accents here, but the ASCII version is already enough to disambiguate between Sebastian working on Lean4 and Sebastien working on calculus and analytic functions</p>



<a name="195880055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880055">(Apr 30 2020 at 18:17)</a>:</h4>
<p>I can't remember the name of the tactic which makes the hidden goals appear :-(</p>



<a name="195880115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880115">(Apr 30 2020 at 18:18)</a>:</h4>
<p><code>recover</code>?</p>



<a name="195880263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880263">(Apr 30 2020 at 18:19)</a>:</h4>
<p>Yeah that's the one. OK I am going back to blaming the sorried data. The problem isn't the <code>exact</code>, it's when Lean is putting everything together afterwards.</p>



<a name="195880299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880299">(Apr 30 2020 at 18:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195880019" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195880019">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="246273">Bhavik Mehta</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195877025" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195877025">said</a>:</p>
<blockquote>
<p>My current hypothesis is that Sebastian's right, and the problem happens when lean is trying to make the bytecode, so I'm currently filling in the sorry</p>
</blockquote>
<p>You probably mean Sébastien here. I don't know why Zulip doesn't use accents here, but the ASCII version is already enough to disambiguate between Sebastian working on Lean4 and Sebastien working on calculus and analytic functions</p>
</blockquote>
<p>Oops, yeah, thanks!</p>



<a name="195880443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880443">(Apr 30 2020 at 18:20)</a>:</h4>
<p>Or as I call them, Sebasti∀n and Sebasti∃n.</p>



<a name="195880444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880444">(Apr 30 2020 at 18:20)</a>:</h4>
<p>Maybe it should be renamed <code>#recover</code>; it's not intended for leaving in proof scripts because it's pretty expensive and usually indicates a bug in another tactic</p>



<a name="195880741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880741">(Apr 30 2020 at 18:22)</a>:</h4>
<p>Another Mario has appeared on the chat, so maybe I need to start going by Mário</p>



<a name="195880831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880831">(Apr 30 2020 at 18:23)</a>:</h4>
<p>We lost track of how many Kevin we have a long time ago.</p>



<a name="195880853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880853">(Apr 30 2020 at 18:23)</a>:</h4>
<p>Hopefully I'll be safe for a while</p>



<a name="195880883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195880883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195880883">(Apr 30 2020 at 18:23)</a>:</h4>
<p>Or maybe I should hope for the opposite</p>



<a name="195889897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195889897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195889897">(Apr 30 2020 at 19:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="246273">Bhavik Mehta</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195860476" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195860476">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195837169" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195837169">said</a>:</p>
<blockquote>
<p>In the past I have occasionally resorted to running Lean in a debugger, then stopping it at a random point and looking at the trace</p>
</blockquote>
<p>How could I do this?</p>
</blockquote>
<p>Depends on your platform I suppose, but I just run lean inside gdb</p>



<a name="195889902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195889902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195889902">(Apr 30 2020 at 19:32)</a>:</h4>
<p>from the command line</p>



<a name="195893897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195893897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195893897">(Apr 30 2020 at 20:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195880263" title="#narrow/stream/113488-general/topic/Diagnosing.20timeout/near/195880263">said</a>:</p>
<blockquote>
<p>Yeah that's the one. OK I am going back to blaming the sorried data. The problem isn't the <code>exact</code>, it's when Lean is putting everything together afterwards.</p>
</blockquote>
<p>This isn't it... I filled in the sorry</p>



<a name="195894018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195894018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195894018">(Apr 30 2020 at 20:04)</a>:</h4>
<p>For those experimenting, I've pushed the updated version - same file</p>



<a name="195991945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195991945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195991945">(May 01 2020 at 18:17)</a>:</h4>
<p>Further confusing this, I've got two other defs which construct a <code>sheaf</code> and they don't have the same problem...</p>



<a name="195994444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Diagnosing%20timeout/near/195994444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Diagnosing.20timeout.html#195994444">(May 01 2020 at 18:41)</a>:</h4>
<p>This is worth more investigation. I've had quite a busy day today and I've got another one tomorrow but I hope to find the time to look at this again, it's not like anything I've seen before which is why I find it interesting. Can you make a branch with the error so it doesn't get lost?</p>



{% endraw %}

<hr><p>Last updated: May 01 2020 at 19:04 UTC</p>