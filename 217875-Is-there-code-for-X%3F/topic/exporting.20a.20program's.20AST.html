---
layout: archive
title: Zulip Chat Archive
permalink: /stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/index.html">Is there code for X?</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html">exporting a program's AST</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="195227505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/exporting%20a%20program%27s%20AST/near/195227505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Petar Maymounkov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html#195227505">(Apr 24 2020 at 18:32)</a>:</h4>
<p>I am investigating using Lean to specify and verify protocols, and then code-generate the protocols in another language (say Go).<br>
In that regard, I am wondering if there is a way to export a complete Lean program's AST in some common format (like JSON/ProtoBuf/etc.)?</p>
<p>Thank you!</p>



<a name="195230396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/exporting%20a%20program%27s%20AST/near/195230396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html#195230396">(Apr 24 2020 at 18:57)</a>:</h4>
<p>That is not currently supported. How would you use that information?</p>



<a name="195230534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/exporting%20a%20program%27s%20AST/near/195230534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html#195230534">(Apr 24 2020 at 18:58)</a>:</h4>
<p>What is supported however is parsing <code>olean</code> files (object files) and extracting the definitions from there. A prototype exists in Rust and it's called <code>rs-olean</code></p>



<a name="195232635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/exporting%20a%20program%27s%20AST/near/195232635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Petar Maymounkov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html#195232635">(Apr 24 2020 at 19:16)</a>:</h4>
<p>For a Lean function to be convertible to a static-typed target language, it must have no dependent types.<br>
So, my reasoning is:</p>
<ol>
<li>Use Lean to define a function F with no dependent types in its own signature. (Inside, the definition of F may invoke dependent-type sub-functions.)</li>
<li>Traverse the definition of F recursively, expanding dependent Lean types (to non-dependent Lean types) as you go.</li>
<li>Map non-dependent Lean types to static types in the target language using a simple translation rule.</li>
</ol>



<a name="195234816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/217875-Is%20there%20code%20for%20X%3F/topic/exporting%20a%20program%27s%20AST/near/195234816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Petar Maymounkov <a href="https://leanprover-community.github.io/archive/stream/217875-Is-there-code-for-X%3F/topic/exporting.20a.20program's.20AST.html#195234816">(Apr 24 2020 at 19:34)</a>:</h4>
<p>I recognize that evaluating the types of function calls may be hard to do from just the AST. An alternative strategy for code-generation would be to implement the generation in Lean itself, using Lean reflection to construct the target language AST and then dump it into an object file. I wonder if Lean supports enough reflection to accomplish this; and also can it write data structures to a file.</p>



{% endraw %}

<hr><p>Last updated: Apr 24 2020 at 20:56 UTC</p>