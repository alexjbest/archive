---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/DVRs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html">DVRs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="188142696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188142696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188142696">(Feb 13 2020 at 19:42)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">discrete_valuation_ring</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">principal_ideal_domain</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">unique_nonzero_max_ideal</span> <span class="o">:</span> <span class="bp">∃!</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">,</span> <span class="n">P</span><span class="bp">.</span><span class="n">is_prime</span> <span class="bp">∧</span> <span class="n">P</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
</pre></div>


<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> what do you think?</p>



<a name="188143009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143009">(Feb 13 2020 at 19:46)</a>:</h4>
<p>Well, we already have <code>local_ring</code></p>



<a name="188143031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143031">(Feb 13 2020 at 19:46)</a>:</h4>
<p>So maybe you should <code>extend</code> that</p>



<a name="188143061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143061">(Feb 13 2020 at 19:46)</a>:</h4>
<p>and then add one extra condition saying that it's not a field</p>



<a name="188143208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143208">(Feb 13 2020 at 19:48)</a>:</h4>
<p>but a general local ring isn't a PID so I need to add that somehow, right?</p>



<a name="188143260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143260">(Feb 13 2020 at 19:49)</a>:</h4>
<p>You are already extending that, right?</p>



<a name="188143271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143271">(Feb 13 2020 at 19:49)</a>:</h4>
<p>I meant, in addition, extend local ring</p>



<a name="188143412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143412">(Feb 13 2020 at 19:51)</a>:</h4>
<p>I wonder whether we'll be happy with <code>[dvr R]</code> and <code>[pid R]</code>, etc... Or that we'd rather have <code>[comm_ring R] [is_dvr R]</code> and <code>[comm_ring R] [is_pid R]</code> etc...</p>



<a name="188143445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143445">(Feb 13 2020 at 19:51)</a>:</h4>
<p>The first version has more chances to lead to diamonds, I think</p>



<a name="188143550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143550">(Feb 13 2020 at 19:52)</a>:</h4>
<p>I never know if I'm allowed to extend PID and local ring because perhaps I just defined two different multiplications or something? I really have no understanding of this stuff and don't know a place where it's all written up coherently. I occasionally half-understand it for a while and then I just forget it all again.</p>



<a name="188143877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143877">(Feb 13 2020 at 19:54)</a>:</h4>
<p>Aha, I think it's fine, but maybe you need to switch on the <code>old_structure_cmd</code></p>



<a name="188145502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188145502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188145502">(Feb 13 2020 at 20:10)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">old_structure_cmd</span> <span class="n">true</span>

<span class="n">class</span> <span class="n">discrete_valuation_ring</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">principal_ideal_domain</span> <span class="n">R</span><span class="o">,</span>
  <span class="n">local_ring</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">pseudouniformiser</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">a</span><span class="o">)</span>
</pre></div>



<a name="188146043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188146043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188146043">(Feb 13 2020 at 20:16)</a>:</h4>
<p>Yeah, that seems fine. Although I would maybe not call the condition <code>pseudouniformiser</code></p>



<a name="188146075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188146075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188146075">(Feb 13 2020 at 20:16)</a>:</h4>
<p><code>exists_nonzero_nonunit</code>?</p>



<a name="195333635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195333635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195333635">(Apr 26 2020 at 12:56)</a>:</h4>
<p>Thinking about the proof that given a DVR you actually get a valuation, there's a slight stumbling block: I want to use <code>enat</code> and then do something like <code>R →*+ enat</code> which should be a map from the DVR <code>R</code> to <code>enat</code> which is a map of monoids, but the problem is that I want to think of <code>R</code> as a multiplicative monoid and <code>enat</code> as an additive monoid: it doesn't seem like <code>→*+</code> exists. One other option is to use multiplicative valuations landing in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb{R}_{\geq 0}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.934069em;vertical-align:-0.24517899999999998em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24517899999999998em;"><span></span></span></span></span></span></span></span></span></span> but then it's not really clear where a uniformizer is supposed to go: there are infinitely many choices, none of which really stand out in general.</p>



<a name="195333813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195333813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195333813">(Apr 26 2020 at 13:02)</a>:</h4>
<p>Is there some systematic way to add in things like <code>→*+</code>?</p>



<a name="195335223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335223">(Apr 26 2020 at 13:38)</a>:</h4>
<p>Alternatively, <code>\bbZ</code> and <code>\bbN</code> have <code>has_le</code>, but <code>multiplicative \bbZ</code> doesn't seem to preserve this, and I'm not sure whether <code>with_zero</code> defines a new ordering...</p>



<a name="195335249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335249">(Apr 26 2020 at 13:39)</a>:</h4>
<p><span class="user-mention" data-user-id="235423">@Ashwin Iyengar</span> they used valuations in <a href="https://leanprover-community.github.io/lean-perfectoid-spaces/" title="https://leanprover-community.github.io/lean-perfectoid-spaces/">the perfectoid project</a> which you might find helpful</p>



<a name="195335498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335498">(Apr 26 2020 at 13:44)</a>:</h4>
<p>Yeah I guess what I want to use is linear_ordered_comm_group_with_zero.lean then: <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> is this destined for mathlib?</p>



<a name="195335533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335533">(Apr 26 2020 at 13:45)</a>:</h4>
<p>But maybe this should be rewritten replacing <code>0</code> with <code>⊥</code> to avoid confusion with <code>0</code> in the integers?</p>



<a name="195336032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195336032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195336032">(Apr 26 2020 at 13:58)</a>:</h4>
<p>I guess I can achieve what I want if I have linear_ordered_comm_group_with_zero.lean, and some way to distinguish between the natural number <code>0</code> and the adjoined <code>0</code></p>



<a name="195338108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195338108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195338108">(Apr 26 2020 at 14:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="235423">Ashwin Iyengar</span> <a href="#narrow/stream/116395-maths/topic/DVRs/near/195335498" title="#narrow/stream/116395-maths/topic/DVRs/near/195335498">said</a>:</p>
<blockquote>
<p>Yeah I guess what I want to use is linear_ordered_comm_group_with_zero.lean then: <span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> is this destined for mathlib?</p>
</blockquote>
<p>I think this can be PR'd. All prerequisites are now in mathlib, if I'm not mistaken. Note that it only works in a multiplicative setting though... so it doesn't yet solve your problem.</p>
<p>I think there are two questions that need to be answered:</p>
<ol>
<li>
<p>Should DVR's use multiplicative or additive valuations?</p>
</li>
<li>
<p>What ever the answer is to (1): what should the target type be of discrete valuations?</p>
</li>
</ol>
<p>Note that we could also opt for a "heretical" approach, in which we take a discrete additive valuation with target type the integers, and we require <code>val 0 = 0</code>, instead of <code>val  0 = infty</code>. This would create it's own problems, but it also solves a lot...</p>



{% endraw %}

<hr><p>Last updated: Apr 26 2020 at 15:03 UTC</p>