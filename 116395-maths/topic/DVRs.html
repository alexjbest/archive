---
layout: archive
title: Zulip Chat Archive
permalink: /stream/116395-maths/topic/DVRs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/index.html">maths</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html">DVRs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="188142696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188142696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188142696">(Feb 13 2020 at 19:42)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">discrete_valuation_ring</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">principal_ideal_domain</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">unique_nonzero_max_ideal</span> <span class="o">:</span> <span class="bp">∃!</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">,</span> <span class="n">P</span><span class="bp">.</span><span class="n">is_prime</span> <span class="bp">∧</span> <span class="n">P</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
</pre></div>


<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> what do you think?</p>



<a name="188143009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143009">(Feb 13 2020 at 19:46)</a>:</h4>
<p>Well, we already have <code>local_ring</code></p>



<a name="188143031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143031">(Feb 13 2020 at 19:46)</a>:</h4>
<p>So maybe you should <code>extend</code> that</p>



<a name="188143061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143061">(Feb 13 2020 at 19:46)</a>:</h4>
<p>and then add one extra condition saying that it's not a field</p>



<a name="188143208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143208">(Feb 13 2020 at 19:48)</a>:</h4>
<p>but a general local ring isn't a PID so I need to add that somehow, right?</p>



<a name="188143260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143260">(Feb 13 2020 at 19:49)</a>:</h4>
<p>You are already extending that, right?</p>



<a name="188143271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143271">(Feb 13 2020 at 19:49)</a>:</h4>
<p>I meant, in addition, extend local ring</p>



<a name="188143412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143412">(Feb 13 2020 at 19:51)</a>:</h4>
<p>I wonder whether we'll be happy with <code>[dvr R]</code> and <code>[pid R]</code>, etc... Or that we'd rather have <code>[comm_ring R] [is_dvr R]</code> and <code>[comm_ring R] [is_pid R]</code> etc...</p>



<a name="188143445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143445">(Feb 13 2020 at 19:51)</a>:</h4>
<p>The first version has more chances to lead to diamonds, I think</p>



<a name="188143550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143550">(Feb 13 2020 at 19:52)</a>:</h4>
<p>I never know if I'm allowed to extend PID and local ring because perhaps I just defined two different multiplications or something? I really have no understanding of this stuff and don't know a place where it's all written up coherently. I occasionally half-understand it for a while and then I just forget it all again.</p>



<a name="188143877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188143877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188143877">(Feb 13 2020 at 19:54)</a>:</h4>
<p>Aha, I think it's fine, but maybe you need to switch on the <code>old_structure_cmd</code></p>



<a name="188145502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188145502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188145502">(Feb 13 2020 at 20:10)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">set_option</span> <span class="n">old_structure_cmd</span> <span class="n">true</span>

<span class="n">class</span> <span class="n">discrete_valuation_ring</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">principal_ideal_domain</span> <span class="n">R</span><span class="o">,</span>
  <span class="n">local_ring</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">pseudouniformiser</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">a</span><span class="o">)</span>
</pre></div>



<a name="188146043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188146043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188146043">(Feb 13 2020 at 20:16)</a>:</h4>
<p>Yeah, that seems fine. Although I would maybe not call the condition <code>pseudouniformiser</code></p>



<a name="188146075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/188146075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#188146075">(Feb 13 2020 at 20:16)</a>:</h4>
<p><code>exists_nonzero_nonunit</code>?</p>



<a name="195333635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195333635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195333635">(Apr 26 2020 at 12:56)</a>:</h4>
<p>Thinking about the proof that given a DVR you actually get a valuation, there's a slight stumbling block: I want to use <code>enat</code> and then do something like <code>R →*+ enat</code> which should be a map from the DVR <code>R</code> to <code>enat</code> which is a map of monoids, but the problem is that I want to think of <code>R</code> as a multiplicative monoid and <code>enat</code> as an additive monoid: it doesn't seem like <code>→*+</code> exists. One other option is to use multiplicative valuations landing in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">R</mi><mrow><mo>≥</mo><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbb{R}_{\geq 0}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.934069em;vertical-align:-0.24517899999999998em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">≥</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24517899999999998em;"><span></span></span></span></span></span></span></span></span></span> but then it's not really clear where a uniformizer is supposed to go: there are infinitely many choices, none of which really stand out in general.</p>



<a name="195333813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195333813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195333813">(Apr 26 2020 at 13:02)</a>:</h4>
<p>Is there some systematic way to add in things like <code>→*+</code>?</p>



<a name="195335223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335223">(Apr 26 2020 at 13:38)</a>:</h4>
<p>Alternatively, <code>\bbZ</code> and <code>\bbN</code> have <code>has_le</code>, but <code>multiplicative \bbZ</code> doesn't seem to preserve this, and I'm not sure whether <code>with_zero</code> defines a new ordering...</p>



<a name="195335249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335249">(Apr 26 2020 at 13:39)</a>:</h4>
<p><span class="user-mention" data-user-id="235423">@Ashwin Iyengar</span> they used valuations in <a href="https://leanprover-community.github.io/lean-perfectoid-spaces/" title="https://leanprover-community.github.io/lean-perfectoid-spaces/">the perfectoid project</a> which you might find helpful</p>



<a name="195335498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335498">(Apr 26 2020 at 13:44)</a>:</h4>
<p>Yeah I guess what I want to use is linear_ordered_comm_group_with_zero.lean then: <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> is this destined for mathlib?</p>



<a name="195335533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195335533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195335533">(Apr 26 2020 at 13:45)</a>:</h4>
<p>But maybe this should be rewritten replacing <code>0</code> with <code>⊥</code> to avoid confusion with <code>0</code> in the integers?</p>



<a name="195336032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195336032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195336032">(Apr 26 2020 at 13:58)</a>:</h4>
<p>I guess I can achieve what I want if I have linear_ordered_comm_group_with_zero.lean, and some way to distinguish between the natural number <code>0</code> and the adjoined <code>0</code></p>



<a name="195338108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195338108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195338108">(Apr 26 2020 at 14:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="235423">Ashwin Iyengar</span> <a href="#narrow/stream/116395-maths/topic/DVRs/near/195335498" title="#narrow/stream/116395-maths/topic/DVRs/near/195335498">said</a>:</p>
<blockquote>
<p>Yeah I guess what I want to use is linear_ordered_comm_group_with_zero.lean then: <span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> is this destined for mathlib?</p>
</blockquote>
<p>I think this can be PR'd. All prerequisites are now in mathlib, if I'm not mistaken. Note that it only works in a multiplicative setting though... so it doesn't yet solve your problem.</p>
<p>I think there are two questions that need to be answered:</p>
<ol>
<li>
<p>Should DVR's use multiplicative or additive valuations?</p>
</li>
<li>
<p>What ever the answer is to (1): what should the target type be of discrete valuations?</p>
</li>
</ol>
<p>Note that we could also opt for a "heretical" approach, in which we take a discrete additive valuation with target type the integers, and we require <code>val 0 = 0</code>, instead of <code>val  0 = infty</code>. This would create it's own problems, but it also solves a lot...</p>



<a name="195339207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195339207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195339207">(Apr 26 2020 at 15:27)</a>:</h4>
<p>Additive is what is usually done, but if we want to do multiplicative instead, one option for the target would be to just use a free group on one generator (written multiplicatively), define the obvious ordering on it, and then use your</p>
<div class="codehilite"><pre><span></span><span class="c">/-</span><span class="cm">- Adjoining a zero element to a linearly ordered commutative group</span>
<span class="cm">gives a linearly ordered commutative group with zero.-/</span>
<span class="kn">instance</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">linear_ordered_comm_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">linear_ordered_comm_group_with_zero</span> <span class="o">(</span><span class="n">with_zero</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span><span class="bp">```</span>
</pre></div>


<p>I'll try this for now.</p>



<a name="195341519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195341519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195341519">(Apr 26 2020 at 16:25)</a>:</h4>
<p>Later on it might be convenient to have valuations taking values in a discrete subgroup of the rationals</p>



<a name="195341580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195341580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195341580">(Apr 26 2020 at 16:26)</a>:</h4>
<p>I think Johan is the expert in valuations now, there has been lot of movement since that valuation file was originally written, especially with group_with_zero</p>



<a name="195341707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195341707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195341707">(Apr 26 2020 at 16:29)</a>:</h4>
<p>We could do something like</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">to_discrete_valuation</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">discrete_valuation_ring</span> <span class="n">R</span><span class="o">]</span>
<span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_group</span> <span class="n">G</span><span class="o">]</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">G</span><span class="o">)</span> <span class="o">(</span><span class="n">cyclic</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">=</span> <span class="n">span</span> <span class="o">{</span><span class="n">g</span><span class="o">})</span> <span class="o">:</span>
<span class="n">discrete_valuation</span> <span class="n">R</span> <span class="n">G</span> <span class="n">g</span> <span class="o">:=</span>
</pre></div>


<p>maybe, and have the discrete valuation take values in an arbitrary infinite cyclic group... oh but I'm missing a proof that it's infinite</p>



<a name="195341852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195341852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195341852">(Apr 26 2020 at 16:33)</a>:</h4>
<p>An alternative is to use the general valuations as found in the perfectoid project, and define a predicate on those, saying that the valuation is discrete.</p>



<a name="195341916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195341916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195341916">(Apr 26 2020 at 16:34)</a>:</h4>
<p>Do you want <code>discrete_valuation_ring R</code> to be a <code>Prop</code> or will it record data (say a distinguished uniformiser...)?</p>



<a name="195342402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342402">(Apr 26 2020 at 16:47)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">discrete_valuation_ring</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">principal_ideal_domain</span> <span class="n">R</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">prime_ideal&#39;</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span>
<span class="o">(</span><span class="n">primality</span> <span class="o">:</span> <span class="n">prime_ideal&#39;</span><span class="bp">.</span><span class="n">is_prime</span><span class="o">)</span>
<span class="o">(</span><span class="n">is_nonzero</span> <span class="o">:</span> <span class="n">prime_ideal&#39;</span> <span class="bp">≠</span> <span class="err">⊥</span><span class="o">)</span>
<span class="o">(</span><span class="n">unique_nonzero_prime_ideal</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">,</span> <span class="n">P</span><span class="bp">.</span><span class="n">is_prime</span> <span class="bp">→</span> <span class="n">P</span> <span class="bp">=</span> <span class="err">⊥</span> <span class="bp">∨</span> <span class="n">P</span> <span class="bp">=</span> <span class="n">prime_ideal&#39;</span><span class="o">)</span>
</pre></div>



<a name="195342405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342405">(Apr 26 2020 at 16:47)</a>:</h4>
<p>so it records some data</p>



<a name="195342447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342447">(Apr 26 2020 at 16:48)</a>:</h4>
<p>a PID with a unique nonzero prime ideal</p>



<a name="195342489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342489">(Apr 26 2020 at 16:50)</a>:</h4>
<p>Ok, I see. But it is a subsingleton. That seems like a fine definition</p>



<a name="195342540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342540">(Apr 26 2020 at 16:50)</a>:</h4>
<p>Then we construct a valuation basically by using the UFD structure and the fact that prime elements are uniformizers</p>



<a name="195342926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342926">(Apr 26 2020 at 17:01)</a>:</h4>
<p>In the perfectoid project we also had the notion of a <code>valued_ring</code>, which was a class that registered a (multiplicative) valuation on the ring.</p>



<a name="195342953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342953">(Apr 26 2020 at 17:02)</a>:</h4>
<p>One could have an is_discrete predicate on a valuation in the sense of Huber and a construction which goes from this to the Z-valued valuation. But I don't think it matters that traditionally the group law on Z with 0 is addition -- why not use multiplicative Z with 0?</p>



<a name="195342997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195342997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195342997">(Apr 26 2020 at 17:02)</a>:</h4>
<p>We might want to have two classes <code>discrete_valuation_ring R</code>, like you propose, and <code>discretely_valued_ring R</code>, for rings like Z_p that have a canonical valuation.</p>



<a name="195343020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343020">(Apr 26 2020 at 17:03)</a>:</h4>
<p>What structure do people use on Z with +infinity? Add, max, probably never multiplication, but external multiplication by Z yes. But we have all this on a group with 0</p>



<a name="195343030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343030">(Apr 26 2020 at 17:03)</a>:</h4>
<p>I'm still upset that it seems really painful to move back and forth between multiplicative and additive valuations...</p>



<a name="195343034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343034">(Apr 26 2020 at 17:03)</a>:</h4>
<p>So why not just bite the bullet and never use additive valuations?</p>



<a name="195343075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343075">(Apr 26 2020 at 17:04)</a>:</h4>
<p>It's either that or make add_group_with_zero</p>



<a name="195343077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343077">(Apr 26 2020 at 17:04)</a>:</h4>
<p>Because sometimes it's really nice and intuitive to reason about <code>int</code></p>



<a name="195343085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343085">(Apr 26 2020 at 17:04)</a>:</h4>
<p>Or with infinity or whatever</p>



<a name="195343088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343088">(Apr 26 2020 at 17:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/116395-maths/topic/DVRs/near/195343075" title="#narrow/stream/116395-maths/topic/DVRs/near/195343075">said</a>:</p>
<blockquote>
<p>It's either that or make add_group_with_zero</p>
</blockquote>
<p><code>add_group_with_infty</code></p>



<a name="195343096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343096">(Apr 26 2020 at 17:04)</a>:</h4>
<p>But I don't think the <code>to_additive</code> machinery is built with such translations in mind...</p>



<a name="195343105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343105">(Apr 26 2020 at 17:05)</a>:</h4>
<p>But I don't think the target Z really is a Z. It's certainly not the ring Z. It's the additive group Z with an occasional infinity</p>



<a name="195343124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343124">(Apr 26 2020 at 17:05)</a>:</h4>
<p>And an action of Z which is either a smul or a gpow</p>



<a name="195343196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343196">(Apr 26 2020 at 17:07)</a>:</h4>
<p>I don't see why we need to introduce the concept of an additive valuation at all. Just because it's in maths in some superficial way doesn't mean we need it. Or we could have it in this one off case. What did Rob use for p-adics?</p>



<a name="195343208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343208">(Apr 26 2020 at 17:07)</a>:</h4>
<p>norms...</p>



<a name="195343272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343272">(Apr 26 2020 at 17:08)</a>:</h4>
<p>I would be happy with multiplicative <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">Z</span></span></span></span></span> with an added 0 element, but won't this cause notational trouble because you have the integer 0 and then the added 0?</p>



<a name="195343296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343296">(Apr 26 2020 at 17:09)</a>:</h4>
<p>There are ways around that.</p>



<a name="195343342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343342">(Apr 26 2020 at 17:10)</a>:</h4>
<p>We could define <code>free_group</code>, or something like that.</p>



<a name="195343348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343348">(Apr 26 2020 at 17:10)</a>:</h4>
<p>As in, don't actually use <code>int</code>, but use a different type.</p>



<a name="195343430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343430">(Apr 26 2020 at 17:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/116395-maths/topic/DVRs/near/195343348" title="#narrow/stream/116395-maths/topic/DVRs/near/195343348">said</a>:</p>
<blockquote>
<p>As in, don't actually use <code>int</code>, but use a different type.</p>
</blockquote>
<p>If you want, we could give it some names like <code>discrete_valuation.target_type</code>, or something fancier...</p>



<a name="195343556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343556">(Apr 26 2020 at 17:14)</a>:</h4>
<p>But it would be best to already include the extra <code>0</code> element in the definition of this type. You don't want to work with <code>with_zero foo</code> all the time, even though in "normal" maths we keep up that facade.</p>



<a name="195343565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343565">(Apr 26 2020 at 17:14)</a>:</h4>
<p>We did that for a long time in the perfectoid project, but it just became too painful.</p>



<a name="195343597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343597">(Apr 26 2020 at 17:15)</a>:</h4>
<p>Still, I wonder if you should settle on 1 target type. It might be better to characterise what it means to be a discrete valuation, as I proposed above.</p>



<a name="195343606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343606">(Apr 26 2020 at 17:15)</a>:</h4>
<p>Because otherwise you will regret it once you get a DVR with a different target type.</p>



<a name="195343651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343651">(Apr 26 2020 at 17:16)</a>:</h4>
<p>(Say some subset of the reals)</p>



<a name="195343661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195343661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195343661">(Apr 26 2020 at 17:16)</a>:</h4>
<p>We should really work to get the definition of a general valuation into mathlib</p>



<a name="195374804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195374804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195374804">(Apr 27 2020 at 05:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I think that sometimes it's useful to view <code>padic_val_int</code> as an <em>actual</em> integer, don't you think? But nevertheless we can probably get away with using multiplicative valuations as the default.</p>
<p><span class="user-mention" data-user-id="235423">@Ashwin Iyengar</span> I'm starting to think that we should just hurry up with PR'ing the basics of valuations from the perfectoid project. Stuff like equivalence of valuations etc would also be useful to you. And it would be silly to have to do all of that again.</p>
<p>Maybe we need a class like <code>normed_valued_ring R</code> that can be used for examples like <code>Z_p</code>, and will register both a norm and a valuation, and an axiom that claims the two are the same thing.</p>



<a name="195378643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195378643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195378643">(Apr 27 2020 at 06:55)</a>:</h4>
<p>Yeah if i have access to the perfectoid project stuff then I'm sure I can just go from there, but no rush</p>



<a name="195382632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/DVRs/near/195382632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/116395-maths/topic/DVRs.html#195382632">(Apr 27 2020 at 07:45)</a>:</h4>
<p>I'll try to prioritise these PRs</p>



{% endraw %}

<hr><p>Last updated: May 05 2020 at 10:05 UTC</p>